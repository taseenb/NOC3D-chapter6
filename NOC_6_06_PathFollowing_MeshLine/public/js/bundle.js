!function o(a,s,c){function h(n,t){if(!s[n]){if(!a[n]){var e="function"==typeof require&&require;if(!t&&e)return e(n,!0);if(l)return l(n,!0);var i=new Error("Cannot find module '"+n+"'");throw i.code="MODULE_NOT_FOUND",i}var r=s[n]={exports:{}};a[n][0].call(r.exports,function(t){var e=a[n][1][t];return h(e||t)},r,r.exports,o,a,s,c)}return s[n].exports}for(var l="function"==typeof require&&require,t=0;t<c.length;t++)h(c[t]);return h}({1:[function(t,m,y){(function(f){function q(t,e,n){function i(t,e){if("download"in d)return d.href=t,d.setAttribute("download",y),d.innerHTML="downloading...",d.style.display="none",u.body.appendChild(d),setTimeout(function(){d.click(),u.body.removeChild(d),!0===e&&setTimeout(function(){s.URL.revokeObjectURL(d.href)},250)},66),!0;var n=u.createElement("iframe");u.body.appendChild(n),e||(t="data:"+t.replace(/^data:([\w\/\-\+]+)/,c)),n.src=t,setTimeout(function(){u.body.removeChild(n)},333)}var r,o,a,s=window,c="application/octet-stream",h=n||c,l=t,u=document,d=u.createElement("a"),p=function(t){return String(t)},f=s.Blob||s.MozBlob||s.WebKitBlob||p,m=s.MSBlobBuilder||s.WebKitBlobBuilder||s.BlobBuilder,y=e||"download";if("true"===String(this)&&(h=(l=[l,h])[0],l=l[1]),String(l).match(/^data\:[\w+\-]+\/[\w+\-]+[,;]/))return navigator.msSaveBlob?navigator.msSaveBlob(function(t){for(var e=t.split(/[:;,]/),n=e[1],i=("base64"==e[2]?atob:decodeURIComponent)(e.pop()),r=i.length,o=0,a=new Uint8Array(r);o<r;++o)a[o]=i.charCodeAt(o);return new f([a],{type:n})}(l),y):i(l);try{r=l instanceof f?l:new f([l],{type:h})}catch(t){m&&((o=new m).append([l]),r=o.getBlob(h))}if(navigator.msSaveBlob)return navigator.msSaveBlob(r,y);if(s.URL)i(s.URL.createObjectURL(r),!0);else{if("string"==typeof r||r.constructor===p)try{return i("data:"+h+";base64,"+s.btoa(r))}catch(t){return i("data:"+h+","+encodeURIComponent(r))}(a=new FileReader).onload=function(t){i(this.result)},a.readAsDataURL(r)}return!0}window.Whammy=function(){function i(t,e){for(var n=function(t){for(var e=t[0].width,n=t[0].height,i=t[0].duration,r=1;r<t.length;r++){if(t[r].width!=e)throw"Frame "+(r+1)+" has a different width";if(t[r].height!=n)throw"Frame "+(r+1)+" has a different height";if(t[r].duration<0||32767<t[r].duration)throw"Frame "+(r+1)+" has a weird duration (must be between 0 and 32767)";i+=t[r].duration}return{duration:i,width:e,height:n}}(t),i=[{id:440786851,data:[{data:1,id:17030},{data:1,id:17143},{data:4,id:17138},{data:8,id:17139},{data:"webm",id:17026},{data:2,id:17031},{data:2,id:17029}]},{id:408125543,data:[{id:357149030,data:[{data:1e6,id:2807729},{data:"whammy",id:19840},{data:"whammy",id:22337},{data:(p=n.duration,[].slice.call(new Uint8Array(new Float64Array([p]).buffer),0).map(function(t){return String.fromCharCode(t)}).reverse().join("")),id:17545}]},{id:374648427,data:[{id:174,data:[{data:1,id:215},{data:1,id:29637},{data:0,id:156},{data:"und",id:2274716},{data:"V_VP8",id:134},{data:"VP8",id:2459272},{data:1,id:131},{id:224,data:[{data:n.width,id:176},{data:n.height,id:186}]}]}]},{id:475249515,data:[]}]}],r=i[1],o=r.data[2],a=0,s=0;a<t.length;){var c={id:187,data:[{data:Math.round(s),id:179},{id:183,data:[{data:1,id:247},{data:0,size:8,id:241}]}]};o.data.push(c);for(var h=[],l=0;h.push(t[a]),l+=t[a].duration,++a<t.length&&l<3e4;);var u=0,d={id:524531317,data:[{data:Math.round(s),id:231}].concat(h.map(function(t){var e=v({discardable:0,frame:t.data.slice(4),invisible:0,keyframe:1,lacing:0,trackNum:1,timecode:Math.round(u)});return u+=t.duration,{data:e,id:163}}))};r.data.push(d),s+=l}for(var p,f=0,m=0;m<r.data.length;m++){3<=m&&(o.data[m-3].data[1].data[1].data=f);var y=g([r.data[m]],e);f+=y.size||y.byteLength||y.length,2!=m&&(r.data[m]=y)}return g(i,e)}function p(t){for(var e=[];0<t;)e.push(255&t),t>>=8;return new Uint8Array(e.reverse())}function f(t,e){for(var n=new Uint8Array(e),i=e-1;0<=i;i--)n[i]=255&t,t>>=8;return n}function m(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}function y(t){var e=[];t=(t.length%8?new Array(9-t.length%8).join("0"):"")+t;for(var n=0;n<t.length;n+=8)e.push(parseInt(t.substr(n,8),2));return new Uint8Array(e)}function g(t,e){for(var n=[],i=0;i<t.length;i++)if("id"in t[i]){var r=t[i].data;"object"==typeof r&&(r=g(r,e)),"number"==typeof r&&(r="size"in t[i]?f(r,t[i].size):y(r.toString(2))),"string"==typeof r&&(r=m(r)),r.length;for(var o=r.size||r.byteLength||r.length,a=0,s=56;0<s;s-=7)if(o>Math.pow(2,s)-2){a=s/7;break}var c=o.toString(2),h=new Array(8*(a+1)+1).join("0"),l=new Array(a+1).join("0")+1,u=l+(h.substr(0,h.length-c.length-l.length)+c);n.push(p(t[i].id)),n.push(y(u)),n.push(r)}else n.push(t[i]);if(e){var d=function t(e,n){null==n&&(n=[]);for(var i=0;i<e.length;i++)"object"==typeof e[i]?t(e[i],n):n.push(e[i]);return n}(n);return new Uint8Array(d)}return new Blob(n,{type:"video/webm"})}function v(t){var e=0;if(t.keyframe&&(e|=128),t.invisible&&(e|=8),t.lacing&&(e|=t.lacing<<1),t.discardable&&(e|=1),127<t.trackNum)throw"TrackNumber > 127 not supported";return[128|t.trackNum,t.timecode>>8,255&t.timecode,e].map(function(t){return String.fromCharCode(t)}).join("")+t.frame}function r(t){for(var e=t.RIFF[0].WEBP[0],n=e.indexOf("¬ù*"),i=0,r=[];i<4;i++)r[i]=e.charCodeAt(n+3+i);var o,a;return o=16383&(a=r[1]<<8|r[0]),a>>14,(a=r[3]<<8|r[2])>>14,{width:o,height:16383&a,data:e,riff:t}}function a(t){for(var e=0,n={};e<t.length;){var i=t.substr(e,4);if(n[i]=n[i]||[],"RIFF"==i||"LIST"==i){var r=parseInt(t.substr(e+4,4).split("").map(function(t){var e=t.charCodeAt(0).toString(2);return new Array(8-e.length+1).join("0")+e}).join(""),2),o=t.substr(e+4+4,r);e+=8+r,n[i].push(a(o))}else"WEBP"==i?n[i].push(t.substr(e+8)):n[i].push(t.substr(e+4)),e=t.length}return n}function t(t,e){this.frames=[],this.duration=1e3/t,this.quality=e||.8}return t.prototype.add=function(t,e){if(void 0!==e&&this.duration)throw"you can't pass a duration if the fps is set";if(void 0===e&&!this.duration)throw"if you don't have the fps set, you need to have durations here.";if(t.canvas&&(t=t.canvas),t.toDataURL)t=t.getContext("2d").getImageData(0,0,t.width,t.height);else if("string"!=typeof t)throw"frame must be a a HTMLCanvasElement, a CanvasRenderingContext2D or a DataURI formatted string";if("string"==typeof t&&!/^data:image\/webp;base64,/gi.test(t))throw"Input must be formatted properly as a base64 encoded DataURI of type image/webp";this.frames.push({image:t,duration:e||this.duration})},t.prototype.encodeFrames=function(n){if(this.frames[0].image instanceof ImageData){var i=this.frames,r=document.createElement("canvas"),o=r.getContext("2d");r.width=this.frames[0].image.width,r.height=this.frames[0].image.height;var a=function(t){var e=i[t];o.putImageData(e.image,0,0),e.image=r.toDataURL("image/webp",this.quality),t<i.length-1?setTimeout(function(){a(t+1)},1):n()}.bind(this);a(0)}else n()},t.prototype.compile=function(e,n){this.encodeFrames(function(){var t=new i(this.frames.map(function(t){var e=r(a(atob(t.image.slice(23))));return e.duration=t.duration,e}),e);n(t)}.bind(this))},{Video:t,fromImageArray:function(t,n,e){return i(t.map(function(t){var e=r(a(atob(t.slice(23))));return e.duration=1e3/n,e}),e)},toWebM:i}}(),function(){"use strict";function o(t){var e,n=new Uint8Array(t);for(e=0;e<t;e+=1)n[e]=0;return n}var s=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","0","1","2","3","4","5","6","7","8","9","+","/"];window.utils={},window.utils.clean=o,window.utils.pad=function(t,e,n){return t=t.toString(n||8),"000000000000".substr(t.length+12-e)+t},window.utils.extend=function(t,e,n,i){var r=o((parseInt((e+n)/i)+1)*i);return r.set(t),r},window.utils.stringToUint8=function(t,e,n){var i,r;for(e=e||o(t.length),n=n||0,i=0,r=t.length;i<r;i+=1)e[n]=t.charCodeAt(i),n+=1;return e},window.utils.uint8ToBase64=function(t){var e,n,i,r,o=t.length%3,a="";for(e=0,i=t.length-o;e<i;e+=3)n=(t[e]<<16)+(t[e+1]<<8)+t[e+2],a+=s[(r=n)>>18&63]+s[r>>12&63]+s[r>>6&63]+s[63&r];switch(a.length%4){case 1:a+="=";break;case 2:a+="=="}return a}}(),function(){"use strict";var e,n=window.utils;e=[{field:"fileName",length:100},{field:"fileMode",length:8},{field:"uid",length:8},{field:"gid",length:8},{field:"fileSize",length:12},{field:"mtime",length:12},{field:"checksum",length:8},{field:"type",length:1},{field:"linkName",length:100},{field:"ustar",length:8},{field:"owner",length:32},{field:"group",length:32},{field:"majorNumber",length:8},{field:"minorNumber",length:8},{field:"filenamePrefix",length:155},{field:"padding",length:12}],window.header={},window.header.structure=e,window.header.format=function(r,t){var o=n.clean(512),a=0;return e.forEach(function(t){var e,n,i=r[t.field]||"";for(e=0,n=i.length;e<n;e+=1)o[a]=i.charCodeAt(e),a+=1;a+=t.length-e}),"function"==typeof t?t(o,a):o}}(),function(){"use strict";function t(t){this.written=0,e=(t||20)*m,this.out=f.clean(e),this.blocks=[],this.length=0}var e,p=window.header,f=window.utils,m=512;t.prototype.append=function(t,e,n,i){var r,o,a,s,c,h,l;if("string"==typeof e)e=f.stringToUint8(e);else if(e.constructor!==Uint8Array.prototype.constructor)throw"Invalid input type. You gave me: "+e.constructor.toString().match(/function\s*([$A-Za-z_][0-9A-Za-z_]*)\s*\(/)[1];"function"==typeof n&&(n,n={}),a=(n=n||{}).mode||4095&parseInt("777",8),s=n.mtime||Math.floor(+new Date/1e3),c=n.uid||0,h=n.gid||0,r={fileName:t,fileMode:f.pad(a,7),uid:f.pad(c,7),gid:f.pad(h,7),fileSize:f.pad(e.length,11),mtime:f.pad(s,11),checksum:"        ",type:"0",ustar:"ustar  ",owner:n.owner||"",group:n.group||""},o=0,Object.keys(r).forEach(function(t){var e,n,i=r[t];for(e=0,n=i.length;e<n;e+=1)o+=i.charCodeAt(e)}),r.checksum=f.pad(o,6)+"\0 ",l=p.format(r);var u=Math.ceil(l.length/m)*m,d=Math.ceil(e.length/m)*m;this.blocks.push({header:l,input:e,headerLength:u,inputLength:d})},t.prototype.save=function(){var i=[],e=[],n=0,r=Math.pow(2,20),o=[];return this.blocks.forEach(function(t){n+t.headerLength+t.inputLength>r&&(e.push({blocks:o,length:n}),o=[],n=0),o.push(t),n+=t.headerLength+t.inputLength}),e.push({blocks:o,length:n}),e.forEach(function(t){var e=new Uint8Array(t.length),n=0;t.blocks.forEach(function(t){e.set(t.header,n),n+=t.headerLength,e.set(t.input,n),n+=t.inputLength}),i.push(e)}),i.push(new Uint8Array(2*m)),new Blob(i,{type:"octet/stream"})},t.prototype.clear=function(){this.written=0,this.out=f.clean(e)},window.Tar=t}(),function(t){function l(t,e){if({}.hasOwnProperty.call(l.cache,t))return l.cache[t];var n=l.resolve(t);if(!n)throw new Error("Failed to resolve module "+t);var i={id:t,require:l,filename:t,exports:{},loaded:!1,parent:e,children:[]};e&&e.children.push(i);var r=t.slice(0,t.lastIndexOf("/")+1);return l.cache[t]=i.exports,n.call(i.exports,i,i.exports,r,t),i.loaded=!0,l.cache[t]=i.exports}l.modules={},l.cache={},l.resolve=function(t){return{}.hasOwnProperty.call(l.modules,t)?l.modules[t]:void 0},l.define=function(t,e){l.modules[t]=e};var e,o=(e="/",{title:"browser",version:"v0.10.26",browser:!0,env:{},argv:[],nextTick:t.setImmediate||function(t){setTimeout(t,0)},cwd:function(){return e},chdir:function(t){e=t}});l.define("/gif.coffee",function(t,e,n,i){function r(t,e){return{}.hasOwnProperty.call(t,e)}var o,a,s,c,h;s=l("events",t).EventEmitter,o=l("/browser.coffee",t),h=function(t){function e(t){var e,n;for(e in this.running=!1,this.options={},this.frames=[],this.freeWorkers=[],this.activeWorkers=[],this.setOptions(t),a)n=a[e],null!=this.options[e]?this.options[e]:this.options[e]=n}return function(t,e){function n(){this.constructor=t}for(var i in e)r(e,i)&&(t[i]=e[i]);n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype}(e,s),a={workerScript:"gif.worker.js",workers:2,repeat:0,background:"#fff",quality:10,width:null,height:null,transparent:null},c={delay:500,copy:!1},e.prototype.setOption=function(t,e){return this.options[t]=e,null==this._canvas||"width"!==t&&"height"!==t?void 0:this._canvas[t]=e},e.prototype.setOptions=function(e){var n,i;return function(t){for(n in e)r(e,n)&&(i=e[n],t.push(this.setOption(n,i)));return t}.call(this,[])},e.prototype.addFrame=function(t,e){var n,i;for(i in null==e&&(e={}),(n={}).transparent=this.options.transparent,c)n[i]=e[i]||c[i];if(null!=this.options.width||this.setOption("width",t.width),null!=this.options.height||this.setOption("height",t.height),"undefined"!=typeof ImageData&&null!=ImageData&&t instanceof ImageData)n.data=t.data;else if("undefined"!=typeof CanvasRenderingContext2D&&null!=CanvasRenderingContext2D&&t instanceof CanvasRenderingContext2D||"undefined"!=typeof WebGLRenderingContext&&null!=WebGLRenderingContext&&t instanceof WebGLRenderingContext)e.copy?n.data=this.getContextData(t):n.context=t;else{if(null==t.childNodes)throw new Error("Invalid image");e.copy?n.data=this.getImageData(t):n.image=t}return this.frames.push(n)},e.prototype.render=function(){var n;if(this.running)throw new Error("Already running");if(null==this.options.width||null==this.options.height)throw new Error("Width and height must be set prior to rendering");this.running=!0,this.nextFrame=0,this.finishedFrames=0,this.imageParts=function(t){for(var e=function(){var t;t=[];for(var e=0;0<=this.frames.length?e<this.frames.length:e>this.frames.length;0<=this.frames.length?++e:--e)t.push(e);return t}.apply(this,arguments),n=0,i=e.length;n<i;++n)e[n],t.push(null);return t}.call(this,[]),n=this.spawnWorkers();for(var t=function(){var t;t=[];for(var e=0;0<=n?e<n:n<e;0<=n?++e:--e)t.push(e);return t}.apply(this,arguments),e=0,i=t.length;e<i;++e)t[e],this.renderNextFrame();return this.emit("start"),this.emit("progress",0)},e.prototype.abort=function(){for(var t;null!=(t=this.activeWorkers.shift());)console.log("killing active worker"),t.terminate();return this.running=!1,this.emit("abort")},e.prototype.spawnWorkers=function(){var n,i;return n=Math.min(this.options.workers,this.frames.length),function(){var t;t=[];for(var e=this.freeWorkers.length;this.freeWorkers.length<=n?e<n:n<e;this.freeWorkers.length<=n?++e:--e)t.push(e);return t}.apply(this,arguments).forEach((i=this,function(t){var e,n;return console.log("spawning worker "+t),(e=new Worker(i.options.workerScript)).onmessage=(n=i,function(t){return n.activeWorkers.splice(n.activeWorkers.indexOf(e),1),n.freeWorkers.push(e),n.frameFinished(t.data)}),i.freeWorkers.push(e)})),n},e.prototype.frameFinished=function(t){return console.log("frame "+t.index+" finished - "+this.activeWorkers.length+" active"),this.finishedFrames++,this.emit("progress",this.finishedFrames/this.frames.length),this.imageParts[t.index]=t,function(t,e){for(var n=0,i=e.length;n<i;++n)if(n in e&&e[n]===t)return!0;return!1}(null,this.imageParts)?this.renderNextFrame():this.finishRendering()},e.prototype.finishRendering=function(){for(var t,e,n,i,r,o,a,s=r=0,c=this.imageParts.length;s<c;++s)r+=((e=this.imageParts[s]).data.length-1)*e.pageSize+e.cursor;r+=e.pageSize-e.cursor,console.log("rendering finished - filesize "+Math.round(r/1e3)+"kb"),t=new Uint8Array(r);for(var h=o=0,l=this.imageParts.length;h<l;++h)for(var u=0,d=(e=this.imageParts[h]).data.length;u<d;++u)a=e.data[u],n=u,t.set(a,o),o+=n===e.data.length-1?e.cursor:e.pageSize;return i=new Blob([t],{type:"image/gif"}),this.emit("finished",i,t)},e.prototype.renderNextFrame=function(){var t,e,n;if(0===this.freeWorkers.length)throw new Error("No free workers");return this.nextFrame>=this.frames.length?void 0:(t=this.frames[this.nextFrame++],n=this.freeWorkers.shift(),e=this.getTask(t),console.log("starting frame "+(e.index+1)+" of "+this.frames.length),this.activeWorkers.push(n),n.postMessage(e))},e.prototype.getContextData=function(t){return t.getImageData(0,0,this.options.width,this.options.height).data},e.prototype.getImageData=function(t){var e;return null!=this._canvas||(this._canvas=document.createElement("canvas"),this._canvas.width=this.options.width,this._canvas.height=this.options.height),(e=this._canvas.getContext("2d")).setFill=this.options.background,e.fillRect(0,0,this.options.width,this.options.height),e.drawImage(t,0,0),this.getContextData(e)},e.prototype.getTask=function(t){var e,n;if(n={index:e=this.frames.indexOf(t),last:e===this.frames.length-1,delay:t.delay,transparent:t.transparent,width:this.options.width,height:this.options.height,quality:this.options.quality,repeat:this.options.repeat,canTransfer:"chrome"===o.name},null!=t.data)n.data=t.data;else if(null!=t.context)n.data=this.getContextData(t.context);else{if(null==t.image)throw new Error("Invalid frame");n.data=this.getImageData(t.image)}return n},e}(),t.exports=h}),l.define("/browser.coffee",function(t,e,n,i){var r,o,a,s,c;s=navigator.userAgent.toLowerCase(),a=navigator.platform.toLowerCase(),o="ie"===(c=s.match(/(opera|ie|firefox|chrome|version)[\s\/:]([\w\d\.]+)?.*?(safari|version[\s\/:]([\w\d\.]+)|$)/)||[null,"unknown",0])[1]&&document.documentMode,(r={name:"version"===c[1]?c[3]:c[1],version:o||parseFloat("opera"===c[1]&&c[4]?c[4]:c[2]),platform:{name:s.match(/ip(?:ad|od|hone)/)?"ios":(s.match(/(?:webos|android)/)||a.match(/mac|win|linux/)||["other"])[0]}})[r.name]=!0,r[r.name+parseInt(r.version,10)]=!0,r.platform[r.platform.name]=!0,t.exports=r}),l.define("events",function(t,e,n,i){o.EventEmitter||(o.EventEmitter=function(){});var r=e.EventEmitter=o.EventEmitter,a="function"==typeof Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)};r.prototype.setMaxListeners=function(t){this._events||(this._events={}),this._events.maxListeners=t},r.prototype.emit=function(t){if("error"===t&&(!this._events||!this._events.error||a(this._events.error)&&!this._events.error.length))throw arguments[1]instanceof Error?arguments[1]:new Error("Uncaught, unspecified 'error' event.");if(!this._events)return!1;var e=this._events[t];if(!e)return!1;if("function"!=typeof e){if(a(e)){for(var n=Array.prototype.slice.call(arguments,1),i=e.slice(),r=0,o=i.length;r<o;r++)i[r].apply(this,n);return!0}return!1}switch(arguments.length){case 1:e.call(this);break;case 2:e.call(this,arguments[1]);break;case 3:e.call(this,arguments[1],arguments[2]);break;default:n=Array.prototype.slice.call(arguments,1);e.apply(this,n)}return!0},r.prototype.addListener=function(t,e){if("function"!=typeof e)throw new Error("addListener only takes instances of Function");if(this._events||(this._events={}),this.emit("newListener",t,e),this._events[t])if(a(this._events[t])){var n;if(!this._events[t].warned)(n=void 0!==this._events.maxListeners?this._events.maxListeners:10)&&0<n&&this._events[t].length>n&&(this._events[t].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[t].length),console.trace());this._events[t].push(e)}else this._events[t]=[this._events[t],e];else this._events[t]=e;return this},r.prototype.on=r.prototype.addListener,r.prototype.once=function(e,n){var i=this;return i.on(e,function t(){i.removeListener(e,t),n.apply(this,arguments)}),this},r.prototype.removeListener=function(t,e){if("function"!=typeof e)throw new Error("removeListener only takes instances of Function");if(!this._events||!this._events[t])return this;var n=this._events[t];if(a(n)){var i=n.indexOf(e);if(i<0)return this;n.splice(i,1),0==n.length&&delete this._events[t]}else this._events[t]===e&&delete this._events[t];return this},r.prototype.removeAllListeners=function(t){return t&&this._events&&this._events[t]&&(this._events[t]=null),this},r.prototype.listeners=function(t){return this._events||(this._events={}),this._events[t]||(this._events[t]=[]),a(this._events[t])||(this._events[t]=[this._events[t]]),this._events[t]}}),t.GIF=l("/gif.coffee")}.call(this,this),function(){"use strict";function t(t){return t&&t.Object===Object?t:null}function n(t){return String("0000000"+t).slice(-7)}function e(t){var n={};this.settings=t,this.on=function(t,e){n[t]=e},this.emit=function(t){var e=n[t];e&&e.apply(null,Array.prototype.slice.call(arguments,1))},this.filename=t.name||function(){function t(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return t()+t()+"-"+t()+"-"+t()+"-"+t()+"-"+t()+t()+t()}(),this.extension="",this.mimeType=""}function i(t){e.call(this,t),this.extension=".tar",this.mimeType="application/x-tar",this.fileExtension="",this.tape=null,this.count=0}function N(t){i.call(this,t),this.type="image/png",this.fileExtension=".png"}function U(t){i.call(this,t),this.type="image/jpeg",this.fileExtension=".jpg",this.quality=t.quality/100||.8}function B(t){"image/webp"!==document.createElement("canvas").toDataURL("image/webp").substr(5,10)&&console.log("WebP not supported - try another export format"),e.call(this,t),this.quality=t.quality/100||.8,this.extension=".webm",this.mimeType="video/webm",this.baseFilename=this.filename,this.frames=[],this.part=1}function _(t){e.call(this,t),t.quality=t.quality/100||.8,this.encoder=new FFMpegServer.Video(t),this.encoder.on("process",function(){this.emit("process")}.bind(this)),this.encoder.on("finished",function(t,e){var n=this.callback;n&&(this.callback=void 0,n(t,e))}.bind(this)),this.encoder.on("progress",function(t){this.settings.onProgress&&this.settings.onProgress(t)}.bind(this)),this.encoder.on("error",function(t){alert(JSON.stringify(t,null,2))}.bind(this))}function V(t){e.call(this,t),this.framerate=this.settings.framerate,this.type="video/webm",this.extension=".webm",this.stream=null,this.mediaRecorder=null,this.chunks=[]}function z(t){e.call(this,t),t.quality=31-(30*t.quality/100||10),t.workers=t.workers||4,this.extension=".gif",this.mimeType="image/gif",this.canvas=document.createElement("canvas"),this.ctx=this.canvas.getContext("2d"),this.sizeSet=!1,this.encoder=new GIF({workers:t.workers,quality:t.quality,workerScript:t.workersPath+"gif.worker.js"}),this.encoder.on("progress",function(t){this.settings.onProgress&&this.settings.onProgress(t)}.bind(this)),this.encoder.on("finished",function(t){var e=this.callback;e&&(this.callback=void 0,e(t))}.bind(this))}function r(t){function i(){w=!1,d.stop(),a("Capturer stop"),window.setTimeout=C,window.setInterval=j,window.clearInterval=D,window.clearTimeout=A,window.requestAnimationFrame=M,window.Date.prototype.getTime=F,window.Date.now=S,window.performance.now=H}function r(t,e){C(t,0,e)}function n(){r(e)}function e(){var t=1e3/p.framerate,e=(y+g/p.motionBlurFrames)*t;c=h+e,l=u+e,I.forEach(function(t){t._hookedTime=e/1e3}),function(){var t=y/p.framerate;(p.frameLimit&&y>=p.frameLimit||p.timeLimit&&t>=p.timeLimit)&&(i(),o());var e=new Date(null);e.setSeconds(t),2<p.motionBlurFrames?E.textContent="CCapture "+p.format+" | "+y+" frames ("+g+" inter) | "+e.toISOString().substr(11,8):E.textContent="CCapture "+p.format+" | "+y+" frames | "+e.toISOString().substr(11,8)}(),a("Frame: "+y+" "+g);for(var n=0;n<f.length;n++)c>=f[n].triggerTime&&(r(f[n].callback),f.splice(n,1));for(n=0;n<m.length;n++)c>=m[n].triggerTime&&(r(m[n].callback),m[n].triggerTime+=m[n].time);v.forEach(function(t){r(t,c-W)}),v=[]}function o(t){t||(t=function(t){return q(t,d.filename+d.extension,d.mimeType),!1}),d.save(t)}function a(t){s&&console.log(t)}var s,c,h,l,u,n,d,p=t||{},f=(new Date,[]),m=[],y=0,g=0,v=[],w=!1,b={};p.framerate=p.framerate||60,p.motionBlurFrames=2*(p.motionBlurFrames||1),s=p.verbose||!1,p.display,p.step=1e3/p.framerate,p.timeLimit=p.timeLimit||0,p.frameLimit=p.frameLimit||0,p.startTime=p.startTime||0;var E=document.createElement("div");E.style.position="absolute",E.style.left=E.style.top=0,E.style.backgroundColor="black",E.style.fontFamily="monospace",E.style.fontSize="11px",E.style.padding="5px",E.style.color="red",E.style.zIndex=1e5,p.display&&document.body.appendChild(E);var k,T,O=document.createElement("canvas"),x=O.getContext("2d");a("Step is set to "+p.step+"ms");var L={gif:z,webm:B,ffmpegserver:_,png:N,jpg:U,"webm-mediarecorder":V},R=L[p.format];if(!R)throw"Error: Incorrect or missing format: Valid formats are "+Object.keys(L).join(", ");if((d=new R(p)).step=n,d.on("process",e),d.on("progress",function(t){!function(t){var e=b[t];e&&e.apply(null,Array.prototype.slice.call(arguments,1))}("progress",t)}),"performance"in window==0&&(window.performance={}),Date.now=Date.now||function(){return(new Date).getTime()},"now"in window.performance==0){var P=Date.now();performance.timing&&performance.timing.navigationStart&&(P=performance.timing.navigationStart),window.performance.now=function(){return Date.now()-P}}var C=window.setTimeout,j=window.setInterval,D=window.clearInterval,A=window.clearTimeout,M=window.requestAnimationFrame,S=window.Date.now,H=window.performance.now,F=window.Date.prototype.getTime,I=[];return{start:function(){(function(){function t(){return this._hooked||(this._hooked=!0,this._hookedTime=this.currentTime||0,this.pause(),I.push(this)),this._hookedTime+p.startTime}a("Capturer start"),h=window.Date.now(),c=h+p.startTime,u=window.performance.now(),l=u+p.startTime,window.Date.prototype.getTime=function(){return c},window.Date.now=function(){return c},window.setTimeout=function(t,e){var n={callback:t,time:e,triggerTime:c+e};return f.push(n),a("Timeout set to "+n.time),n},window.clearTimeout=function(t){for(var e=0;e<f.length;e++)f[e]!=t||(f.splice(e,1),a("Timeout cleared"))},window.setInterval=function(t,e){var n={callback:t,time:e,triggerTime:c+e};return m.push(n),a("Interval set to "+n.time),n},window.clearInterval=function(t){return a("clear Interval"),null},window.requestAnimationFrame=function(t){v.push(t)},window.performance.now=function(){return l};try{Object.defineProperty(HTMLVideoElement.prototype,"currentTime",{get:t}),Object.defineProperty(HTMLAudioElement.prototype,"currentTime",{get:t})}catch(t){a(t)}})(),d.start(),w=!0},capture:function(t){var e;w&&(2<p.motionBlurFrames?(e=t,O.width===e.width&&O.height===e.height||(O.width=e.width,O.height=e.height,k=new Uint16Array(O.height*O.width*4),x.fillStyle="#0",x.fillRect(0,0,O.width,O.height)),function(t){x.drawImage(t,0,0),T=x.getImageData(0,0,O.width,O.height);for(var e=0;e<k.length;e+=4)k[e]+=T.data[e],k[e+1]+=T.data[e+1],k[e+2]+=T.data[e+2];g++}(t),g>=.5*p.motionBlurFrames?function(){for(var t=T.data,e=0;e<k.length;e+=4)t[e]=2*k[e]/p.motionBlurFrames,t[e+1]=2*k[e+1]/p.motionBlurFrames,t[e+2]=2*k[e+2]/p.motionBlurFrames;for(x.putImageData(T,0,0),d.add(O),g=0,a("Full MB Frame! "+ ++y+" "+c),e=0;e<k.length;e+=4)k[e]=0,k[e+1]=0,k[e+2]=0;gc()}():n()):(d.add(t),a("Full Frame! "+ ++y)))},stop:i,save:o,on:function(t,e){b[t]=e}}}var o={function:!0,object:!0},a=(parseFloat,parseInt,o[typeof y]&&y&&!y.nodeType?y:void 0),s=o[typeof m]&&m&&!m.nodeType?m:void 0,c=s&&s.exports===a?a:void 0,h=t(a&&s&&"object"==typeof f&&f),l=t(o[typeof self]&&self),u=t(o[typeof window]&&window),d=t(o[typeof this]&&this),p=h||u!==(d&&d.window)&&u||l||d||Function("return this")();"gc"in window||(window.gc=function(){}),HTMLCanvasElement.prototype.toBlob||Object.defineProperty(HTMLCanvasElement.prototype,"toBlob",{value:function(t,e,n){for(var i=atob(this.toDataURL(e,n).split(",")[1]),r=i.length,o=new Uint8Array(r),a=0;a<r;a++)o[a]=i.charCodeAt(a);t(new Blob([o],{type:e||"image/png"}))}}),function(){if("performance"in window==0&&(window.performance={}),Date.now=Date.now||function(){return(new Date).getTime()},"now"in window.performance==0){var t=Date.now();performance.timing&&performance.timing.navigationStart&&(t=performance.timing.navigationStart),window.performance.now=function(){return Date.now()-t}}}();var W=window.Date.now();e.prototype.start=function(){},e.prototype.stop=function(){},e.prototype.add=function(){},e.prototype.save=function(){},e.prototype.dispose=function(){},e.prototype.safeToProceed=function(){return!0},e.prototype.step=function(){console.log("Step not set!")},(i.prototype=Object.create(e.prototype)).start=function(){this.dispose()},i.prototype.add=function(t){var e=new FileReader;e.onload=function(){this.tape.append(n(this.count)+this.fileExtension,new Uint8Array(e.result)),this.count++,this.step()}.bind(this),e.readAsArrayBuffer(t)},i.prototype.save=function(t){t(this.tape.save())},i.prototype.dispose=function(){this.tape=new Tar,this.count=0},(N.prototype=Object.create(i.prototype)).add=function(t){t.toBlob(function(t){i.prototype.add.call(this,t)}.bind(this),this.type)},(U.prototype=Object.create(i.prototype)).add=function(t){t.toBlob(function(t){i.prototype.add.call(this,t)}.bind(this),this.type,this.quality)},(B.prototype=Object.create(e.prototype)).start=function(t){this.dispose()},B.prototype.add=function(t){this.frames.push(t.toDataURL("image/webp",this.quality)),0<this.settings.autoSaveTime&&this.frames.length/this.settings.framerate>=this.settings.autoSaveTime?this.save(function(t){this.filename=this.baseFilename+"-part-"+n(this.part),q(t,this.filename+this.extension,this.mimeType),this.dispose(),this.part++,this.filename=this.baseFilename+"-part-"+n(this.part),this.step()}.bind(this)):this.step()},B.prototype.save=function(t){if(this.frames.length){var e=Whammy.fromImageArray(this.frames,this.settings.framerate);t(new Blob([e],{type:"octet/stream"}))}},B.prototype.dispose=function(t){this.frames=[]},(_.prototype=Object.create(e.prototype)).start=function(){this.encoder.start(this.settings)},_.prototype.add=function(t){this.encoder.add(t)},_.prototype.save=function(t){this.callback=t,this.encoder.end()},_.prototype.safeToProceed=function(){return this.encoder.safeToProceed()},(V.prototype=Object.create(e.prototype)).add=function(t){this.stream||(this.stream=t.captureStream(this.framerate),this.mediaRecorder=new MediaRecorder(this.stream),this.mediaRecorder.start(),this.mediaRecorder.ondataavailable=function(t){this.chunks.push(t.data)}.bind(this)),this.step()},V.prototype.save=function(n){this.mediaRecorder.onstop=function(t){var e=new Blob(this.chunks,{type:"video/webm"});this.chunks=[],n(e)}.bind(this),this.mediaRecorder.stop()},(z.prototype=Object.create(e.prototype)).add=function(t){this.sizeSet||(this.encoder.setOption("width",t.width),this.encoder.setOption("height",t.height),this.sizeSet=!0),this.canvas.width=t.width,this.canvas.height=t.height,this.ctx.drawImage(t,0,0),this.encoder.addFrame(this.ctx,{copy:!0,delay:this.settings.step}),this.step()},z.prototype.save=function(t){this.callback=t,this.encoder.render()},(u||l||{}).CCapture=r,"function"==typeof define&&"object"==typeof define.amd&&define.amd?define(function(){return r}):a&&s?(c&&((s.exports=r).CCapture=r),a.CCapture=r):p.CCapture=r}()}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],2:[function(t,e,n){"use strict";var i=String.prototype.replace,r=/%20/g;e.exports={default:"RFC3986",formatters:{RFC1738:function(t){return i.call(t,r,"+")},RFC3986:function(t){return t}},RFC1738:"RFC1738",RFC3986:"RFC3986"}},{}],3:[function(t,e,n){"use strict";var i=t("./stringify"),r=t("./parse"),o=t("./formats");e.exports={formats:o,parse:r,stringify:i}},{"./formats":2,"./parse":4,"./stringify":5}],4:[function(t,e,n){"use strict";var h=t("./utils"),d=Object.prototype.hasOwnProperty,p={allowDots:!1,allowPrototypes:!1,arrayLimit:20,decoder:h.decode,delimiter:"&",depth:5,parameterLimit:1e3,plainObjects:!1,strictNullHandling:!1},l=function(t,e,n){if(t){var i=n.allowDots?t.replace(/\.([^.[]+)/g,"[$1]"):t,r=/(\[[^[\]]*])/g,o=/(\[[^[\]]*])/.exec(i),a=o?i.slice(0,o.index):i,s=[];if(a){if(!n.plainObjects&&d.call(Object.prototype,a)&&!n.allowPrototypes)return;s.push(a)}for(var c=0;null!==(o=r.exec(i))&&c<n.depth;){if(c+=1,!n.plainObjects&&d.call(Object.prototype,o[1].slice(1,-1))&&!n.allowPrototypes)return;s.push(o[1])}return o&&s.push("["+i.slice(o.index)+"]"),function(t,e,n){for(var i=e,r=t.length-1;0<=r;--r){var o,a=t[r];if("[]"===a)o=(o=[]).concat(i);else{o=n.plainObjects?Object.create(null):{};var s="["===a.charAt(0)&&"]"===a.charAt(a.length-1)?a.slice(1,-1):a,c=parseInt(s,10);!isNaN(c)&&a!==s&&String(c)===s&&0<=c&&n.parseArrays&&c<=n.arrayLimit?(o=[])[c]=i:o[s]=i}i=o}return i}(s,e,n)}};e.exports=function(t,e){var n=e?h.assign({},e):{};if(null!==n.decoder&&void 0!==n.decoder&&"function"!=typeof n.decoder)throw new TypeError("Decoder has to be a function.");if(n.ignoreQueryPrefix=!0===n.ignoreQueryPrefix,n.delimiter="string"==typeof n.delimiter||h.isRegExp(n.delimiter)?n.delimiter:p.delimiter,n.depth="number"==typeof n.depth?n.depth:p.depth,n.arrayLimit="number"==typeof n.arrayLimit?n.arrayLimit:p.arrayLimit,n.parseArrays=!1!==n.parseArrays,n.decoder="function"==typeof n.decoder?n.decoder:p.decoder,n.allowDots="boolean"==typeof n.allowDots?n.allowDots:p.allowDots,n.plainObjects="boolean"==typeof n.plainObjects?n.plainObjects:p.plainObjects,n.allowPrototypes="boolean"==typeof n.allowPrototypes?n.allowPrototypes:p.allowPrototypes,n.parameterLimit="number"==typeof n.parameterLimit?n.parameterLimit:p.parameterLimit,n.strictNullHandling="boolean"==typeof n.strictNullHandling?n.strictNullHandling:p.strictNullHandling,""===t||null==t)return n.plainObjects?Object.create(null):{};for(var i="string"==typeof t?function(t,e){for(var n={},i=e.ignoreQueryPrefix?t.replace(/^\?/,""):t,r=e.parameterLimit===1/0?void 0:e.parameterLimit,o=i.split(e.delimiter,r),a=0;a<o.length;++a){var s,c,h=o[a],l=h.indexOf("]="),u=-1===l?h.indexOf("="):l+1;-1===u?(s=e.decoder(h,p.decoder),c=e.strictNullHandling?null:""):(s=e.decoder(h.slice(0,u),p.decoder),c=e.decoder(h.slice(u+1),p.decoder)),d.call(n,s)?n[s]=[].concat(n[s]).concat(c):n[s]=c}return n}(t,n):t,r=n.plainObjects?Object.create(null):{},o=Object.keys(i),a=0;a<o.length;++a){var s=o[a],c=l(s,i[s],n);r=h.merge(r,c,n)}return h.compact(r)}},{"./utils":6}],5:[function(t,e,n){"use strict";var T=t("./utils"),O=t("./formats"),x={brackets:function(t){return t+"[]"},indices:function(t,e){return t+"["+e+"]"},repeat:function(t){return t}},i=Date.prototype.toISOString,L={delimiter:"&",encode:!0,encoder:T.encode,encodeValuesOnly:!1,serializeDate:function(t){return i.call(t)},skipNulls:!1,strictNullHandling:!1},R=function t(e,n,i,r,o,a,s,c,h,l,u,d){var p=e;if("function"==typeof s)p=s(n,p);else if(p instanceof Date)p=l(p);else if(null===p){if(r)return a&&!d?a(n,L.encoder):n;p=""}if("string"==typeof p||"number"==typeof p||"boolean"==typeof p||T.isBuffer(p))return a?[u(d?n:a(n,L.encoder))+"="+u(a(p,L.encoder))]:[u(n)+"="+u(String(p))];var f,m=[];if(void 0===p)return m;if(Array.isArray(s))f=s;else{var y=Object.keys(p);f=c?y.sort(c):y}for(var g=0;g<f.length;++g){var v=f[g];o&&null===p[v]||(m=Array.isArray(p)?m.concat(t(p[v],i(n,v),i,r,o,a,s,c,h,l,u,d)):m.concat(t(p[v],n+(h?"."+v:"["+v+"]"),i,r,o,a,s,c,h,l,u,d)))}return m};e.exports=function(t,e){var n=t,i=e?T.assign({},e):{};if(null!==i.encoder&&void 0!==i.encoder&&"function"!=typeof i.encoder)throw new TypeError("Encoder has to be a function.");var r=void 0===i.delimiter?L.delimiter:i.delimiter,o="boolean"==typeof i.strictNullHandling?i.strictNullHandling:L.strictNullHandling,a="boolean"==typeof i.skipNulls?i.skipNulls:L.skipNulls,s="boolean"==typeof i.encode?i.encode:L.encode,c="function"==typeof i.encoder?i.encoder:L.encoder,h="function"==typeof i.sort?i.sort:null,l=void 0!==i.allowDots&&i.allowDots,u="function"==typeof i.serializeDate?i.serializeDate:L.serializeDate,d="boolean"==typeof i.encodeValuesOnly?i.encodeValuesOnly:L.encodeValuesOnly;if(void 0===i.format)i.format=O.default;else if(!Object.prototype.hasOwnProperty.call(O.formatters,i.format))throw new TypeError("Unknown format option provided.");var p,f,m=O.formatters[i.format];"function"==typeof i.filter?n=(f=i.filter)("",n):Array.isArray(i.filter)&&(p=f=i.filter);var y,g=[];if("object"!=typeof n||null===n)return"";y=i.arrayFormat in x?i.arrayFormat:"indices"in i?i.indices?"indices":"repeat":"indices";var v=x[y];p||(p=Object.keys(n)),h&&p.sort(h);for(var w=0;w<p.length;++w){var b=p[w];a&&null===n[b]||(g=g.concat(R(n[b],b,v,o,a,s?c:null,f,h,l,u,m,d)))}var E=g.join(r),k=!0===i.addQueryPrefix?"?":"";return 0<E.length?k+E:""}},{"./formats":2,"./utils":6}],6:[function(t,e,o){"use strict";var a=Object.prototype.hasOwnProperty,s=function(){for(var t=[],e=0;e<256;++e)t.push("%"+((e<16?"0":"")+e.toString(16)).toUpperCase());return t}();o.arrayToObject=function(t,e){for(var n=e&&e.plainObjects?Object.create(null):{},i=0;i<t.length;++i)void 0!==t[i]&&(n[i]=t[i]);return n},o.merge=function(n,i,r){if(!i)return n;if("object"!=typeof i){if(Array.isArray(n))n.push(i);else{if("object"!=typeof n)return[n,i];(r.plainObjects||r.allowPrototypes||!a.call(Object.prototype,i))&&(n[i]=!0)}return n}if("object"!=typeof n)return[n].concat(i);var t=n;return Array.isArray(n)&&!Array.isArray(i)&&(t=o.arrayToObject(n,r)),Array.isArray(n)&&Array.isArray(i)?(i.forEach(function(t,e){a.call(n,e)?n[e]&&"object"==typeof n[e]?n[e]=o.merge(n[e],t,r):n.push(t):n[e]=t}),n):Object.keys(i).reduce(function(t,e){var n=i[e];return a.call(t,e)?t[e]=o.merge(t[e],n,r):t[e]=n,t},t)},o.assign=function(t,n){return Object.keys(n).reduce(function(t,e){return t[e]=n[e],t},t)},o.decode=function(e){try{return decodeURIComponent(e.replace(/\+/g," "))}catch(t){return e}},o.encode=function(t){if(0===t.length)return t;for(var e="string"==typeof t?t:String(t),n="",i=0;i<e.length;++i){var r=e.charCodeAt(i);45===r||46===r||95===r||126===r||48<=r&&r<=57||65<=r&&r<=90||97<=r&&r<=122?n+=e.charAt(i):r<128?n+=s[r]:r<2048?n+=s[192|r>>6]+s[128|63&r]:r<55296||57344<=r?n+=s[224|r>>12]+s[128|r>>6&63]+s[128|63&r]:(i+=1,r=65536+((1023&r)<<10|1023&e.charCodeAt(i)),n+=s[240|r>>18]+s[128|r>>12&63]+s[128|r>>6&63]+s[128|63&r])}return n},o.compact=function(t){for(var e=[{obj:{o:t},prop:"o"}],n=[],i=0;i<e.length;++i)for(var r=e[i],o=r.obj[r.prop],a=Object.keys(o),s=0;s<a.length;++s){var c=a[s],h=o[c];"object"==typeof h&&null!==h&&-1===n.indexOf(h)&&(e.push({obj:o,prop:c}),n.push(h))}return function(t){for(var e;t.length;){var n=t.pop();if(e=n.obj[n.prop],Array.isArray(e)){for(var i=[],r=0;r<e.length;++r)void 0!==e[r]&&i.push(e[r]);n.obj[n.prop]=i}}return e}(e)},o.isRegExp=function(t){return"[object RegExp]"===Object.prototype.toString.call(t)},o.isBuffer=function(t){return null!=t&&!!(t.constructor&&t.constructor.isBuffer&&t.constructor.isBuffer(t))}},{}],7:[function(t,e,n){e.exports=function(Y){function t(t,e){var n,i,r,o,a;this.object=t,this.domElement=void 0!==e?e:document,this.enabled=!0,this.target=new Y.Vector3,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.25,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.enableKeys=!0,this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40},this.mouseButtons={ORBIT:Y.MOUSE.LEFT,ZOOM:Y.MOUSE.MIDDLE,PAN:Y.MOUSE.RIGHT},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=function(){return f.phi},this.getAzimuthalAngle=function(){return f.theta},this.reset=function(){s.target.copy(s.target0),s.object.position.copy(s.position0),s.object.zoom=s.zoom0,s.object.updateProjectionMatrix(),s.dispatchEvent(c),s.update(),d=u.NONE},this.update=(n=new Y.Vector3,i=(new Y.Quaternion).setFromUnitVectors(t.up,new Y.Vector3(0,1,0)),r=i.clone().inverse(),o=new Y.Vector3,a=new Y.Quaternion,function(){var t=s.object.position;return n.copy(t).sub(s.target),n.applyQuaternion(i),f.setFromVector3(n),s.autoRotate&&d===u.NONE&&C(2*Math.PI/60/60*s.autoRotateSpeed),f.theta+=m.theta,f.phi+=m.phi,f.theta=Math.max(s.minAzimuthAngle,Math.min(s.maxAzimuthAngle,f.theta)),f.phi=Math.max(s.minPolarAngle,Math.min(s.maxPolarAngle,f.phi)),f.makeSafe(),f.radius*=y,f.radius=Math.max(s.minDistance,Math.min(s.maxDistance,f.radius)),s.target.add(g),n.setFromSpherical(f),n.applyQuaternion(r),t.copy(s.target).add(n),s.object.lookAt(s.target),!0===s.enableDamping?(m.theta*=1-s.dampingFactor,m.phi*=1-s.dampingFactor):m.set(0,0,0),y=1,g.set(0,0,0),!!(v||o.distanceToSquared(s.object.position)>p||8*(1-a.dot(s.object.quaternion))>p)&&(s.dispatchEvent(c),o.copy(s.object.position),a.copy(s.object.quaternion),v=!1,!0)}),this.dispose=function(){s.domElement.removeEventListener("contextmenu",Z,!1),s.domElement.removeEventListener("mousedown",U,!1),s.domElement.removeEventListener("wheel",V,!1),s.domElement.removeEventListener("touchstart",W,!1),s.domElement.removeEventListener("touchend",G,!1),s.domElement.removeEventListener("touchmove",q,!1),document.removeEventListener("mousemove",B,!1),document.removeEventListener("mouseup",_,!1),window.removeEventListener("keydown",z,!1)};var s=this,c={type:"change"},h={type:"start"},l={type:"end"},u={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_DOLLY:4,TOUCH_PAN:5},d=u.NONE,p=1e-6,f=new Y.Spherical,m=new Y.Spherical,y=1,g=new Y.Vector3,v=!1,w=new Y.Vector2,b=new Y.Vector2,E=new Y.Vector2,k=new Y.Vector2,T=new Y.Vector2,O=new Y.Vector2,x=new Y.Vector2,L=new Y.Vector2,R=new Y.Vector2;function P(){return Math.pow(.95,s.zoomSpeed)}function C(t){m.theta-=t}function j(t){m.phi-=t}var D,A,M,S=(D=new Y.Vector3,function(t,e){D.setFromMatrixColumn(e,0),D.multiplyScalar(-t),g.add(D)}),H=(A=new Y.Vector3,function(t,e){A.setFromMatrixColumn(e,1),A.multiplyScalar(t),g.add(A)}),F=(M=new Y.Vector3,function(t,e){var n=s.domElement===document?s.domElement.body:s.domElement;if(s.object instanceof Y.PerspectiveCamera){var i=s.object.position;M.copy(i).sub(s.target);var r=M.length();r*=Math.tan(s.object.fov/2*Math.PI/180),S(2*t*r/n.clientHeight,s.object.matrix),H(2*e*r/n.clientHeight,s.object.matrix)}else s.object instanceof Y.OrthographicCamera?(S(t*(s.object.right-s.object.left)/s.object.zoom/n.clientWidth,s.object.matrix),H(e*(s.object.top-s.object.bottom)/s.object.zoom/n.clientHeight,s.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),s.enablePan=!1)});function I(t){s.object instanceof Y.PerspectiveCamera?y/=t:s.object instanceof Y.OrthographicCamera?(s.object.zoom=Math.max(s.minZoom,Math.min(s.maxZoom,s.object.zoom*t)),s.object.updateProjectionMatrix(),v=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),s.enableZoom=!1)}function N(t){s.object instanceof Y.PerspectiveCamera?y*=t:s.object instanceof Y.OrthographicCamera?(s.object.zoom=Math.max(s.minZoom,Math.min(s.maxZoom,s.object.zoom/t)),s.object.updateProjectionMatrix(),v=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),s.enableZoom=!1)}function U(t){if(!1!==s.enabled){if(t.preventDefault(),t.button===s.mouseButtons.ORBIT){if(!1===s.enableRotate)return;i=t,w.set(i.clientX,i.clientY),d=u.ROTATE}else if(t.button===s.mouseButtons.ZOOM){if(!1===s.enableZoom)return;n=t,x.set(n.clientX,n.clientY),d=u.DOLLY}else if(t.button===s.mouseButtons.PAN){if(!1===s.enablePan)return;e=t,k.set(e.clientX,e.clientY),d=u.PAN}var e,n,i;d!==u.NONE&&(document.addEventListener("mousemove",B,!1),document.addEventListener("mouseup",_,!1),s.dispatchEvent(h))}}function B(t){var e,n;if(!1!==s.enabled)if(t.preventDefault(),d===u.ROTATE){if(!1===s.enableRotate)return;!function(t){b.set(t.clientX,t.clientY),E.subVectors(b,w);var e=s.domElement===document?s.domElement.body:s.domElement;C(2*Math.PI*E.x/e.clientWidth*s.rotateSpeed),j(2*Math.PI*E.y/e.clientHeight*s.rotateSpeed),w.copy(b),s.update()}(t)}else if(d===u.DOLLY){if(!1===s.enableZoom)return;n=t,L.set(n.clientX,n.clientY),R.subVectors(L,x),0<R.y?I(P()):R.y<0&&N(P()),x.copy(L),s.update()}else if(d===u.PAN){if(!1===s.enablePan)return;e=t,T.set(e.clientX,e.clientY),O.subVectors(T,k),F(O.x,O.y),k.copy(T),s.update()}}function _(t){!1!==s.enabled&&(document.removeEventListener("mousemove",B,!1),document.removeEventListener("mouseup",_,!1),s.dispatchEvent(l),d=u.NONE)}function V(t){var e;!1===s.enabled||!1===s.enableZoom||d!==u.NONE&&d!==u.ROTATE||(t.preventDefault(),t.stopPropagation(),(e=t).deltaY<0?N(P()):0<e.deltaY&&I(P()),s.update(),s.dispatchEvent(h),s.dispatchEvent(l))}function z(t){!1!==s.enabled&&!1!==s.enableKeys&&!1!==s.enablePan&&function(t){switch(t.keyCode){case s.keys.UP:F(0,s.keyPanSpeed),s.update();break;case s.keys.BOTTOM:F(0,-s.keyPanSpeed),s.update();break;case s.keys.LEFT:F(s.keyPanSpeed,0),s.update();break;case s.keys.RIGHT:F(-s.keyPanSpeed,0),s.update()}}(t)}function W(t){if(!1!==s.enabled){switch(t.touches.length){case 1:if(!1===s.enableRotate)return;a=t,w.set(a.touches[0].pageX,a.touches[0].pageY),d=u.TOUCH_ROTATE;break;case 2:if(!1===s.enableZoom)return;i=(n=t).touches[0].pageX-n.touches[1].pageX,r=n.touches[0].pageY-n.touches[1].pageY,o=Math.sqrt(i*i+r*r),x.set(0,o),d=u.TOUCH_DOLLY;break;case 3:if(!1===s.enablePan)return;e=t,k.set(e.touches[0].pageX,e.touches[0].pageY),d=u.TOUCH_PAN;break;default:d=u.NONE}var e,n,i,r,o,a;d!==u.NONE&&s.dispatchEvent(h)}}function q(t){var e,n,i,r,o;if(!1!==s.enabled)switch(t.preventDefault(),t.stopPropagation(),t.touches.length){case 1:if(!1===s.enableRotate)return;if(d!==u.TOUCH_ROTATE)return;!function(t){b.set(t.touches[0].pageX,t.touches[0].pageY),E.subVectors(b,w);var e=s.domElement===document?s.domElement.body:s.domElement;C(2*Math.PI*E.x/e.clientWidth*s.rotateSpeed),j(2*Math.PI*E.y/e.clientHeight*s.rotateSpeed),w.copy(b),s.update()}(t);break;case 2:if(!1===s.enableZoom)return;if(d!==u.TOUCH_DOLLY)return;i=(n=t).touches[0].pageX-n.touches[1].pageX,r=n.touches[0].pageY-n.touches[1].pageY,o=Math.sqrt(i*i+r*r),L.set(0,o),R.subVectors(L,x),0<R.y?N(P()):R.y<0&&I(P()),x.copy(L),s.update();break;case 3:if(!1===s.enablePan)return;if(d!==u.TOUCH_PAN)return;e=t,T.set(e.touches[0].pageX,e.touches[0].pageY),O.subVectors(T,k),F(O.x,O.y),k.copy(T),s.update();break;default:d=u.NONE}}function G(t){!1!==s.enabled&&(s.dispatchEvent(l),d=u.NONE)}function Z(t){t.preventDefault()}s.domElement.addEventListener("contextmenu",Z,!1),s.domElement.addEventListener("mousedown",U,!1),s.domElement.addEventListener("wheel",V,!1),s.domElement.addEventListener("touchstart",W,!1),s.domElement.addEventListener("touchend",G,!1),s.domElement.addEventListener("touchmove",q,!1),window.addEventListener("keydown",z,!1),this.update()}return(t.prototype=Object.create(Y.EventDispatcher.prototype)).constructor=t,Object.defineProperties(t.prototype,{center:{get:function(){return console.warn("THREE.OrbitControls: .center has been renamed to .target"),this.target}},noZoom:{get:function(){return console.warn("THREE.OrbitControls: .noZoom has been deprecated. Use .enableZoom instead."),!this.enableZoom},set:function(t){console.warn("THREE.OrbitControls: .noZoom has been deprecated. Use .enableZoom instead."),this.enableZoom=!t}},noRotate:{get:function(){return console.warn("THREE.OrbitControls: .noRotate has been deprecated. Use .enableRotate instead."),!this.enableRotate},set:function(t){console.warn("THREE.OrbitControls: .noRotate has been deprecated. Use .enableRotate instead."),this.enableRotate=!t}},noPan:{get:function(){return console.warn("THREE.OrbitControls: .noPan has been deprecated. Use .enablePan instead."),!this.enablePan},set:function(t){console.warn("THREE.OrbitControls: .noPan has been deprecated. Use .enablePan instead."),this.enablePan=!t}},noKeys:{get:function(){return console.warn("THREE.OrbitControls: .noKeys has been deprecated. Use .enableKeys instead."),!this.enableKeys},set:function(t){console.warn("THREE.OrbitControls: .noKeys has been deprecated. Use .enableKeys instead."),this.enableKeys=!t}},staticMoving:{get:function(){return console.warn("THREE.OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead."),!this.enableDamping},set:function(t){console.warn("THREE.OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead."),this.enableDamping=!t}},dynamicDampingFactor:{get:function(){return console.warn("THREE.OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead."),this.dampingFactor},set:function(t){console.warn("THREE.OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead."),this.dampingFactor=t}}}),t}},{}],8:[function(t,e,n){"use strict";var i=function(){function i(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t}}();var s=t("./Palette"),r=function(){function a(t,e,n,i,r,o){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),this.id=t,this.scene=e,this.p=o,this.startPosition=(new THREE.Vector3).copy(n),this.position=(new THREE.Vector3).copy(this.startPosition),this.maxspeed=i,this.maxforce=r,this.velocity=new THREE.Vector3(i,0,0),this.acceleration=new THREE.Vector3,this.desired=new THREE.Vector3,this.steer=new THREE.Vector3,this.palette=new s,this.color=this.palette.get(this.id),this.lineMaterial=new THREE.LineBasicMaterial({color:this.color,transparent:!1}),this.vehicle=new THREE.Object3D,this.initDebug();this.initTrail(5+~~(20*Math.random()),"linear")}return i(a,[{key:"initDebug",value:function(){var e=this;this.debug=!1,this.normalPoints=[];for(var t=0;t<this.p.pointsCount-1;t++){var n=new THREE.MeshBasicMaterial({color:3355443,transparent:!1}),i=new THREE.BoxBufferGeometry(.2,.2,.2),r=new THREE.Mesh(i,n);this.normalPoints.push(r),this.scene.add(r)}var o=new THREE.Geometry;o.vertices.push(new THREE.Vector3,new THREE.Vector3),this.predictLine=new THREE.Line(o,this.lineMaterial),this.predictLine.frustumCulled=!1;var a=new THREE.Geometry;a.vertices.push(new THREE.Vector3,new THREE.Vector3),this.normalLine=new THREE.Line(a,this.lineMaterial),this.normalLine.frustumCulled=!1,this.scene.add(this.predictLine),this.scene.add(this.normalLine),document.body.addEventListener("keyup",function(t){"d"!==t.key&&"D"!==t.key||(e.debug=!e.debug),e.updateDebugVisibility()}),this.updateDebugVisibility()}},{key:"updateDebugVisibility",value:function(){var e=this;this.predictLine.visible=this.debug,this.normalLine.visible=this.debug,this.normalPoints.forEach(function(t){t.visible=e.debug})}},{key:"resetDebug",value:function(){this.predictLine.geometry.vertices[0].copy(this.position),this.predictLine.geometry.vertices[1].copy(this.position),this.normalLine.geometry.vertices[0].copy(this.position),this.normalLine.geometry.vertices[1].copy(this.position),this.predictLine.geometry.verticesNeedUpdate=!0,this.normalLine.geometry.verticesNeedUpdate=!0}},{key:"updateDebug",value:function(){this.predictLine.geometry.vertices[0].copy(this.position),this.predictLine.geometry.vertices[1].copy(this.predictPosition),this.normalLine.geometry.vertices[0].copy(this.predictPosition),this.normalLine.geometry.vertices[1].copy(this.normalPoint),this.predictLine.geometry.verticesNeedUpdate=!0,this.normalLine.geometry.verticesNeedUpdate=!0}},{key:"initTrail",value:function(t,e){var n=this;this.trail=!0;for(var i=new THREE.Geometry,r=0;r<t;r++)i.vertices.push(this.position.clone());switch(this.line=new window.MeshLine,e){case"none":this.line.setGeometry(i);break;case"linear":this.line.setGeometry(i,function(t){return t});break;case"parabolic":this.line.setGeometry(i,function(t){return 1*Maf.parabola(t,1)});break;case"wavy":this.line.setGeometry(i,function(t){return 2+Math.sin(50*t)})}this.lineMaterial=new window.MeshLineMaterial({color:new THREE.Color(this.color),lineWidth:.4,resolution:new THREE.Vector2(window.innerWidth,window.innerHeight),opacity:1,sizeAttenuation:!0,depthTest:!1}),this.lineMesh=new THREE.Mesh(this.line.geometry,this.lineMaterial),this.lineMesh.frustumCulled=!1,this.scene.add(this.lineMesh),window.addEventListener("resize",function(){clearTimeout(n.resizeDebounce),n.resizeDebounce=setTimeout(function(){n.lineMesh.material.uniforms.resolution.value.copy(new THREE.Vector2(window.innerWidth,window.innerHeight))},250)})}},{key:"updateTrail",value:function(){this.line.advance(this.position)}},{key:"resetTrail",value:function(){for(var t=this.lineMesh.geometry,e=t.attributes.position.array.length,n=0;n<e;n+=3)t.attributes.position.array[n]=this.position.x,t.attributes.position.array[n+1]=this.position.y,t.attributes.position.array[n+2]=this.position.z;t.attributes.position.needsUpdate=!0}},{key:"isPointOnSegment",value:function(t,e,n){var i=t.distanceTo(e)-(n.distanceTo(t)+n.distanceTo(e));return i<.1&&-.1<i}},{key:"follow",value:function(t){this.predictPosition=this.velocity.clone(),this.predictPosition.normalize().multiplyScalar(4),this.predictPosition.add(this.position);for(var e,n=null,i=null,r=1/0,o=0;o<t.pointsCount-1;o++){var a=t.points[o],s=t.points[o+1];n=this.getNormalPoint(this.predictPosition,a,s),this.debug&&this.normalPoints[o].position.copy(n);var c=void 0;if(this.isPointOnSegment(a,s,n))c=this.predictPosition.distanceTo(n);else{var h=this.predictPosition.distanceTo(a),l=this.predictPosition.distanceTo(s);c=Math.min(h,l),n=h<l?a:s}if(c<r){r=c,this.normalPoint=n;var u=(e=void 0,new THREE.Vector3(e)).subVectors(s,a).normalize();u.multiplyScalar(10*(1-1/c)),(i=this.normalPoint.clone()).add(u)}}r>t.radius&&this.seek(i)}},{key:"seek",value:function(t){t.x&&t.y&&(this.desired.subVectors(t,this.position),this.desired.normalize(),this.desired.multiplyScalar(1),this.steer.subVectors(this.desired,this.velocity),this.steer.clampScalar(-this.maxforce,this.maxforce),this.applyForce(this.steer))}},{key:"getNormalPoint",value:function(t,e,n){var i=(new THREE.Vector3).subVectors(t,e),r=(new THREE.Vector3).subVectors(n,e);return r.normalize(),r.multiplyScalar(i.dot(r)),(new THREE.Vector3).addVectors(e,r)}},{key:"checkBoundaries",value:function(){this.position.x>this.p.points[this.p.pointsCount-1].x&&(this.position.copy(this.startPosition),this.resetDebug(),this.resetTrail())}},{key:"update",value:function(){this.velocity.add(this.acceleration),this.velocity.clampScalar(-this.maxspeed,this.maxspeed),this.position.add(this.velocity),this.acceleration.multiplyScalar(0),this.trail&&this.updateTrail(),this.debug&&this.updateDebug(),this.checkBoundaries()}},{key:"applyForce",value:function(t){this.acceleration.add(t)}},{key:"draw",value:function(){this.vehicle.position.copy(this.position),this.vehicle.rotation.y=Math.atan2(-this.velocity.z,this.velocity.x),this.vehicle.rotation.z=Math.asin(this.velocity.y/this.velocity.length())}}]),a}();e.exports=r},{"./Palette":9}],9:[function(t,e,n){"use strict";var i=function(){function i(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t}}();var r=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.colors=["#CFF09E","#A8DBA8","#79BD9A","#3B8686","#0B486B","#69D2E7","#A7DBD8","#E0E4CC","#F38630","#FA6900"]}return i(t,[{key:"get",value:function(t){return t=t||0,this.colors[t%this.colors.length]}},{key:"getRandomColor",value:function(){var t=Math.floor(this.colors.length*Math.random());return this.colors[t]}}]),t}();e.exports=r},{}],10:[function(t,e,n){"use strict";var i=function(){function i(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t}}();var r=function(){function a(t,e,n,i,r,o){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),this.scene=t,this.width=n||40,this.height=i||20,this.depth=r||20,this.pointsCount=e,this.points=[],this.radius=o||3,this.startX=-this.width/2,this.endX=this.width/2,this.init()}return i(a,[{key:"createPoints",value:function(){var t=(this.endX-this.startX)/(this.pointsCount-1);this.points=[];for(var e=0;e<this.pointsCount;e++){var n=new THREE.Vector3;n.x=this.startX+t*e,n.y=Math.random()*this.height,n.z=Math.random()*this.depth-this.depth/2,this.points.push(n)}}},{key:"update",value:function(){var n=this;this.line.geometry.vertices.forEach(function(t,e){t.copy(n.points[e])}),this.line.geometry.verticesNeedUpdate=!0}},{key:"toggleVisibilty",value:function(){}},{key:"init",value:function(){var e=this;this.createPoints();var n=new THREE.Geometry;this.points.forEach(function(t){n.vertices.push(t)});var t=new THREE.LineBasicMaterial({color:6710886});this.line=new THREE.Line(n,t),this.scene.add(this.line),document.body.addEventListener("keyup",function(t){"v"!==t.key&&"V"!==t.key||e.line&&(e.line.visible=!e.line.visible)})}}]),a}();e.exports=r},{}],11:[function(t,e,n){"use strict";var i=function(){function i(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t}}();var r=t("ccapture.js"),o=t("three-orbit-controls")(THREE),a=t("./Boid"),s=t("./Path"),c=t("qs").parse(window.location.search.replace("?",""));new(function(){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),this.lastTime=0,this.useDolly=!1,this.animate=!0,this.options={boids:10},Object.assign(this.options,t||{}),window.addEventListener("resize",this.onResize.bind(this),!1),this.onResize()}return i(e,[{key:"init3dScene",value:function(){var t=this;if(this.showUI=1!==parseInt(c["no-ui"]),this.useDolly=1===parseInt(c["use-dolly"]),this.demoMode=1===parseInt(c["demo-mode"]),this.showGrid=1===parseInt(c["show-grid"]),this.cameraDistance=parseInt(c["camera-distance"]),this.showUI||(document.getElementById("ui-btn").style.display="none"),this.demoMode){var e=setInterval(function(){t.useDolly=!t.useDolly},1e4);setInterval(function(){t.renewPath()},25e3),document.addEventListener("click",function(){clearInterval(e)})}this.scene=new THREE.Scene,this.renderer=new THREE.WebGLRenderer({antialias:!0}),this.renderer.setClearColor(13421772,1),this.renderer.setSize(this.width,this.height),document.body.appendChild(this.renderer.domElement),this.camera=new THREE.PerspectiveCamera(60,this.width/this.height,.01,1e4),this.camera.position.z=this.cameraDistance||80,this.camera.position.y=20,this.dolly=new THREE.PerspectiveCamera(60,this.width/this.height,.01,1e4),this.dolly.rotation.y=90*Math.PI/180,this.controls=new o(this.camera,document.body),this.pathMaxWidth=100,this.pathMaxHeight=20,this.pathMaxDepth=30,this.pointsCount=6;this.path=new s(this.scene,this.pointsCount,this.pathMaxWidth,this.pathMaxHeight,this.pathMaxDepth,2),this.boids=[];for(var n=0;n<this.options.boids;n++){var i=.2+.1*Math.random(),r=new THREE.Vector3;r.x=this.path.points[0].x,r.y=this.path.points[0].y*Math.random(),r.z=this.path.points[0].z*Math.random(),this.boids.push(new a(n,this.scene,r,i,.005,this.path))}this.grid=new THREE.Mesh(new THREE.PlaneBufferGeometry(40,40,10,10),new THREE.MeshBasicMaterial({wireframe:!0,color:"#999999",transparent:!0,opacity:.2})),this.grid.visible=this.showGrid,this.grid.rotation.x=90*Math.PI/180,this.scene.add(this.grid)}},{key:"update",value:function(){window.requestAnimationFrame(this.update.bind(this)),this.stats.begin();var t=window.performance.now(),e=(t-this.lastTime)/1e3;1<e&&(e=1),this.lastTime=t,this.render(t,e),this.stats.end()}},{key:"render",value:function(t,e){var n=this;if(this.boids.forEach(function(t){n.animate&&(t.follow(n.path),t.update()),t.draw()}),this.useDolly){var i=this.boids[this.options.boids-1];this.dolly.position.set(i.position.x-20,i.position.y,i.position.z+10),this.dolly.lookAt(i.position)}this.useDolly?this.renderer.render(this.scene,this.dolly):this.renderer.render(this.scene,this.camera),this.capture&&this.capturer.capture(this.renderer.domElement)}},{key:"initStats",value:function(){this.stats=new window.Stats,this.stats.showPanel(0),this.stats.dom.id="stats",document.getElementById("ui").appendChild(this.stats.dom)}},{key:"initEvents",value:function(){var i=this;document.body.addEventListener("keyup",function(t){if("r"===t.key||"R"===t.key)for(var e=0,n=i.boids.length;e<n;e++)i.boids[e].position.copy(i.boids[e].startPosition),i.boids[e].trail&&i.boids[e].resetTrail();"g"!==t.key&&"G"!==t.key||(i.grid.visible=!i.grid.visible),"a"!==t.key&&"A"!==t.key||(i.animate=!i.animate),"p"!==t.key&&"P"!==t.key||i.renewPath(),"c"!==t.key&&"C"!==t.key||(i.useDolly=!i.useDolly)})}},{key:"renewPath",value:function(){this.path.createPoints(),this.path.update()}},{key:"initUI",value:function(){document.body.classList.remove("show-loader"),document.body.classList.add("show-ui-btn"),document.getElementById("ui-btn").addEventListener("click",function(t){document.body.classList.toggle("show-ui")}),this.initStats()}},{key:"initCapture",value:function(){var t=this;this.capture=!1,this.capturer=new r({format:"png"});var e=document.getElementById("captureBtn");e.addEventListener("click",function(){t.capture=!t.capture,t.capture?(e.classList.remove("off"),e.classList.add("on"),t.capturer.start()):(e.classList.remove("on"),e.classList.add("off"),t.capturer.stop(),t.capturer.save())})}},{key:"onResize",value:function(){this.width=window.innerWidth,this.height=window.innerHeight,this.halfWidth=this.width/2,this.halfHeight=this.height/2,this.camera&&(this.camera.aspect=this.width/this.height,this.camera.updateProjectionMatrix()),this.renderer&&this.renderer.setSize(this.width,this.height)}},{key:"start",value:function(){this.init3dScene(),this.initUI(),this.initEvents(),this.initCapture(),this.update()}}]),e}())({boids:100}).start()},{"./Boid":8,"./Path":10,"ccapture.js":1,qs:3,"three-orbit-controls":7}]},{},[11]);
